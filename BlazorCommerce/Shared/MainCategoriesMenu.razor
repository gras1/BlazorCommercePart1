@using System.Net.Http
@inject HttpClient Http

<div class="col-lg-3">
    <div class="all-category">
        <h3 class="cat-heading"><i class="fa fa-bars" aria-hidden="true"></i>CATEGORIES</h3>
        <ul class="main-category">
            <li><a href="/new-arrivals">New Arrivals</a></li>
            <li class="main-mega"><a href="#">best selling <i class="fa fa-angle-right" aria-hidden="true"></i></a>
                @if (_bestSellingCategories != null)
                {
                <ul class="mega-menu">
                    <li class="single-menu">
                        <a href="/metacategory/@_bestSellingCategories.ChildrenAndBabies.FriendlyName" class="title-link">Shop @_bestSellingCategories.ChildrenAndBabies.Name</a>
                        <div class="image">
                            <img src="@_bestSellingCategories.ChildrenAndBabies.ImageUrl" alt="#">
                        </div>
                        <div class="inner-link">
                            @foreach (var bestSellingCategory in _bestSellingCategories.ChildrenAndBabies.BestSellingLeafCategories)
                            {
                            <a href="/category/@bestSellingCategory.FriendlyUrl">@bestSellingCategory.Name</a>
                            }
                        </div>
                    </li>
                    <li class="single-menu">
                        <a href="/metacategory/@_bestSellingCategories.Mens.FriendlyName" class="title-link">Shop @_bestSellingCategories.Mens.Name</a>
                        <div class="image">
                            <img src="@_bestSellingCategories.Mens.ImageUrl" alt="#">
                        </div>
                        <div class="inner-link">
                            @foreach (var bestSellingCategory in _bestSellingCategories.Mens.BestSellingLeafCategories)
                            {
                            <a href="/category/@bestSellingCategory.FriendlyUrl">@bestSellingCategory.Name</a>
                            }
                        </div>
                    </li>
                    <li class="single-menu">
                        <a href="/metacategory/@_bestSellingCategories.Womens.FriendlyName" class="title-link">Shop @_bestSellingCategories.Womens.Name</a>
                        <div class="image">
                            <img src="@_bestSellingCategories.Womens.ImageUrl" alt="#">
                        </div>
                        <div class="inner-link">
                            @foreach (var bestSellingCategory in _bestSellingCategories.Womens.BestSellingLeafCategories)
                            {
                            <a href="/category/@bestSellingCategory.FriendlyUrl">@bestSellingCategory.Name</a>
                            }
                        </div>
                    </li>
                </ul>
                }
            </li>
            @if (_menuCategories != null)
            {
                @foreach (var menuCategory in _menuCategories)
                {
                <li><a href="/category/@menuCategory.FriendlyUrl">@menuCategory.Name</a></li>
                }
            }
        </ul>
    </div>
</div>

@code {
    private BlazorCommerce.Shared.BestSellingCategoriesDto _bestSellingCategories;
    
    private List<MenuCategoryDto> _menuCategories;

	protected override async Task OnInitializedAsync() {
        _bestSellingCategories = await Http.GetFromJsonAsync<BlazorCommerce.Shared.BestSellingCategoriesDto>("category/bestsellingcategories");
        _menuCategories = await Http.GetFromJsonAsync<List<MenuCategoryDto>>("category/menucategories");
	}
}