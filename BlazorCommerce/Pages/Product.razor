@page "/product/{friendlyProductUrl}"

@inject AppState AppState

@using System.Net.Http
@inject HttpClient Http

@inject IJSRuntime JSRuntime

    <!-- Breadcrumbs -->
    <div class="breadcrumbs">
        <div class="container">
            <div class="row">
                <div class="col-12">
                    <div class="bread-inner">
                        <ul class="bread-list">
                            <li><a href="/">Home<i class="ti-arrow-right"></i></a></li>
                            @if (_product != null)
                            {
                            <li><a href="metacategory/@_product.MetaCategoryFriendlyUrl">@_product.MetaCategory</a><i class="ti-arrow-right"></i></li>
                            <li><a href="category/@_product.LeafCategoryFriendlyUrl">@_product.LeafCategory</a><i class="ti-arrow-right"></i></li>
                            <li class="active"><a href="product/@friendlyProductUrl">@_product.Title</a></li>
                            }
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- End Breadcrumbs -->
    <!-- Shop Single -->
    <section class="shop single section">
        <div class="container">
            <div class="row">
                <div class="col-12">
                    <div class="row">
                        <div class="col-lg-6 col-12">
                            <!-- Product Slider -->
                            <div class="product-gallery">
                                <!-- Images slider -->
                                <div class="flexslider-thumbnails">
                                    <ul class="slides">
                                        @if (_product != null)
                                        {
                                            <li data-thumb="@_product.MainImageThumbnailUrl" rel="adjustX:10, adjustY:">
                                                <img src="@_product.MainImageUrl" alt="#">
                                            </li>
                                            @if (!string.IsNullOrEmpty(_product.SecondImageUrl))
                                            {
                                            <li data-thumb="@_product.SecondImageThumbnailUrl">
                                                <img src="@_product.SecondImageUrl" alt="#">
                                            </li>
                                            }
                                            @if (!string.IsNullOrEmpty(_product.ThirdImageUrl))
                                            {
                                            <li data-thumb="@_product.ThirdImageThumbnailUrl">
                                                <img src="@_product.ThirdImageUrl" alt="#">
                                            </li>
                                            }
                                            @if (!string.IsNullOrEmpty(_product.FourthImageUrl))
                                            {
                                            <li data-thumb="@_product.FourthImageThumbnailUrl">
                                                <img src="@_product.FourthImageUrl" alt="#">
                                            </li>
                                            }
                                        }
                                    </ul>
                                </div>
                                <!-- End Images slider -->
                            </div>
                            <!-- End Product slider -->
                        </div>
                        <div class="col-lg-6 col-12">
                            <div class="product-des">
                                <!-- Description -->
                                <div class="short">
                                    @if (_product != null)
                                    {
                                    <h4>@_product.Title</h4>
                                    }
                                    <div class="rating-main">
                                        <ul class="rating">
                                            <li><i class="fa fa-star"></i></li>
                                            <li><i class="fa fa-star"></i></li>
                                            <li><i class="fa fa-star"></i></li>
                                            <li><i class="fa fa-star-half-o"></i></li>
                                            <li class="dark"><i class="fa fa-star-o"></i></li>
                                        </ul><a href="#" class="total-review">(102) Review</a>
                                    </div>
                                    @if (_product != null)
                                    {
                                    <p class="price"><span class="discount">@ProductPrice</span></p>
                                    <p class="description">@_product.BriefDescription</p>
                                    <input id="selectedProductOptionProductInstanceId" type="hidden" @bind="ProductOptionProductInstanceId" />
                                    }
                                </div>
                                <!--/ End Description -->
                                @if (_product != null && _product.ProductOptionType != "N/A")
                                {
                                <!-- Product Options -->
                                <div class="color"><h4>Available Options</h4></div>
                                <div class="size">
                                    <h4>@_product.ProductOptionType</h4>
                                    <ul>
                                        @foreach (var productOption in _product.ProductOptions)
                                        {
                                        <li><button @onclick="() => UpdateSelectedProductOption(productOption.ProductOptionProductInstanceId, productOption.Price, productOption.Stock)" class='@string.Format("{0}", productOption.ProductOptionProductInstanceId == _product.ProductOptionProductInstanceId ? "selected" : string.Empty)'>@productOption.Option</button></li>
                                        }
                                    </ul>
                                </div>
                                <!--/ Product Options -->
                                }
                                <!-- Product Buy -->
                                <div class="product-buy">
                                    <div class="quantity">
                                        <h6>Quantity :</h6>
                                        <!-- Input Order -->
                                        <div class="input-group">
                                            <div class="button minus">
                                                <button type="button" class="btn btn-primary btn-number" @onclick="() => DecrementQuantity()">
                                                    <i class="ti-minus"></i>
                                                </button>
                                            </div>
                                            @if (_product != null)
                                            {
                                            <input type="text" class="input-number" readonly value="@ProductQuantity">
                                            }
                                            <div class="button plus">
                                                <button type="button" class="btn btn-primary btn-number" @onclick="() => IncrementQuantity()">
                                                    <i class="ti-plus"></i>
                                                </button>
                                            </div>
                                        </div>
                                        <!--/ End Input Order -->
                                    </div>
                                    <div class="add-to-cart">
                                        <button class="btn" @onclick="AddItemToCart">Add to cart</button>
                                        <a href="#" class="btn min"><i class="ti-heart"></i></a>
                                        <a href="#" class="btn min"><i class="fa fa-compress"></i></a>
                                    </div>
                                    @if (_product != null)
                                    {
                                    <p class="cat">Category :<a href="category/@_product.LeafCategoryFriendlyUrl">@string.Concat(_product.MetaCategory, " ", _product.LeafCategory)</a></p>
                                    <p class="availability">Availability : @ProductStock Products In Stock</p>
                                    }
                                </div>
                                <!--/ End Product Buy -->
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-12">
                            <div class="product-info">
                                <div class="nav-main">
                                    <!-- Tab Nav -->
                                    <ul class="nav nav-tabs" id="myTab" role="tablist">
                                        <li class="nav-item"><a class="nav-link active" data-toggle="tab" href="#description" role="tab">Description</a></li>
                                        <li class="nav-item"><a class="nav-link" data-toggle="tab" href="#reviews" role="tab">Reviews</a></li>
                                    </ul>
                                    <!--/ End Tab Nav -->
                                </div>
                                <div class="tab-content" id="myTabContent">
                                    <!-- Description Tab -->
                                    <div class="tab-pane fade show active" id="description" role="tabpanel">
                                        <div class="tab-single">
                                            <div class="row">
                                                <div class="col-12">
                                                    @if (_product != null)
                                                    {
                                                    <div class="single-des">
                                                        @((MarkupString)DoPlaceholderReplacements(_product.FullDescription))
                                                    </div>
                                                    }
                                                    <div class="single-des">
                                                        <h4>Product Features:</h4>
                                                        <ul>
                                                        @if (_product != null)
                                                        {
                                                            @foreach (var feature in _product.Features)
                                                            {
                                                            <li>@feature</li>
                                                            }
                                                        }
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <!--/ End Description Tab -->
                                    <!-- Reviews Tab -->
                                    <div class="tab-pane fade" id="reviews" role="tabpanel">
                                        <div class="tab-single review-panel">
                                            <div class="row">
                                                <div class="col-12">
                                                    <div class="ratting-main">
                                                        <div class="avg-ratting">
                                                            <h4>4.5 <span>(Overall)</span></h4><span>Based on 1 Comments</span></div>
                                                        <!-- Single Rating -->
                                                        <div class="single-rating">
                                                            <div class="rating-author"><img src="images/comments1.jpg" alt="#"></div>
                                                            <div class="rating-des">
                                                                <h6>Naimur Rahman</h6>
                                                                <div class="ratings">
                                                                    <ul class="rating">
                                                                        <li><i class="fa fa-star"></i></li>
                                                                        <li><i class="fa fa-star"></i></li>
                                                                        <li><i class="fa fa-star"></i></li>
                                                                        <li><i class="fa fa-star-half-o"></i></li>
                                                                        <li><i class="fa fa-star-o"></i></li>
                                                                    </ul>
                                                                    <div class="rate-count">(<span>3.5</span>)</div>
                                                                </div>
                                                                <p>Duis tincidunt mauris ac aliquet congue. Donec vestibulum consequat cursus. Aliquam pellentesque nulla dolor, in imperdiet.</p>
                                                            </div>
                                                        </div>
                                                        <!--/ End Single Rating -->
                                                        <!-- Single Rating -->
                                                        <div class="single-rating">
                                                            <div class="rating-author"><img src="images/comments2.jpg" alt="#"></div>
                                                            <div class="rating-des">
                                                                <h6>Advin Geri</h6>
                                                                <div class="ratings">
                                                                    <ul class="rating">
                                                                        <li><i class="fa fa-star"></i></li>
                                                                        <li><i class="fa fa-star"></i></li>
                                                                        <li><i class="fa fa-star"></i></li>
                                                                        <li><i class="fa fa-star"></i></li>
                                                                        <li><i class="fa fa-star"></i></li>
                                                                    </ul>
                                                                    <div class="rate-count">(<span>5.0</span>)</div>
                                                                </div>
                                                                <p>Duis tincidunt mauris ac aliquet congue. Donec vestibulum consequat cursus. Aliquam pellentesque nulla dolor, in imperdiet.</p>
                                                            </div>
                                                        </div>
                                                        <!--/ End Single Rating -->
                                                    </div>
                                                    <!-- Review -->
                                                    <div class="comment-review">
                                                        <div class="add-review">
                                                            <h5>Add A Review</h5>
                                                            <p>Your email address will not be published. Required fields are marked</p>
                                                        </div>
                                                        <h4>Your Rating</h4>
                                                        <div class="review-inner">
                                                            <div class="ratings">
                                                                <ul class="rating">
                                                                    <li><i class="fa fa-star"></i></li>
                                                                    <li><i class="fa fa-star"></i></li>
                                                                    <li><i class="fa fa-star"></i></li>
                                                                    <li><i class="fa fa-star"></i></li>
                                                                    <li><i class="fa fa-star"></i></li>
                                                                </ul>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <!--/ End Review -->
                                                    <!-- Form -->
                                                    <form class="form" method="post" action="mail/mail.php">
                                                        <div class="row">
                                                            <div class="col-lg-6 col-12">
                                                                <div class="form-group">
                                                                    <label>Your Name<span>*</span></label>
                                                                    <input type="text" name="name" required="required" placeholder=""> </div>
                                                            </div>
                                                            <div class="col-lg-6 col-12">
                                                                <div class="form-group">
                                                                    <label>Your Email<span>*</span></label>
                                                                    <input type="email" name="email" required="required" placeholder=""> </div>
                                                            </div>
                                                            <div class="col-lg-12 col-12">
                                                                <div class="form-group">
                                                                    <label>Write a review<span>*</span></label>
                                                                    <textarea name="message" rows="6" placeholder=""></textarea>
                                                                </div>
                                                            </div>
                                                            <div class="col-lg-12 col-12">
                                                                <div class="form-group button5">
                                                                    <button type="submit" class="btn">Submit</button>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </form>
                                                    <!--/ End Form -->
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <!--/ End Reviews Tab -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!--/ End Shop Single -->
    <!-- Start Most Popular -->
    <div class="product-area most-popular related-product section">
        <div class="container">
            <div class="row">
                <div class="col-12">
                    <div class="section-title">
                        <h2>Related Products</h2></div>
                </div>
            </div>
            <div class="row">
                <div class="col-12">
                    <div class="owl-carousel popular-slider owl-theme owl-loaded">
                        <!-- Start Single Product -->
                        <!-- End Single Product -->
                        <!-- Start Single Product -->
                        <!-- End Single Product -->
                        <!-- Start Single Product -->
                        <!-- End Single Product -->
                        <!-- Start Single Product -->
                        <!-- End Single Product -->
                        <div class="owl-stage-outer">
                            <div class="owl-stage" style="transform: translate3d(-1995px, 0px, 0px); transition: all 0.4s ease 0s; width: 3420px">
                                <div class="owl-item cloned" style="width: 285px; margin-right: 0px">
                                    <div class="single-product">
                                        <div class="product-img">
                                            <a href="product-details.html"><img class="default-img" src="images/products/p15.jpg" alt="#"> <img class="hover-img" src="images/products/p16.jpg" alt="#"> <span class="out-of-stock">Hot</span></a>
                                            <div class="button-head">
                                                <div class="product-action"><a data-toggle="modal" data-target="#exampleModal" title="Quick View" href="#"><i class="ti-eye"></i><span>Quick Shop</span></a> <a title="Wishlist" href="#"><i class="ti-heart"></i><span>Add to Wishlist</span></a> <a title="Compare" href="#"><i class="ti-bar-chart-alt"></i><span>Add to Compare</span></a></div>
                                                <div class="product-action-2"><a title="Add to cart" href="#">Add to cart</a></div>
                                            </div>
                                        </div>
                                        <div class="product-content">
                                            <h3><a href="product-details.html">Black Sunglass For Women</a></h3>
                                            <div class="product-price"><span class="old">$60.00</span> <span>$50.00</span></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="owl-item cloned" style="width: 285px; margin-right: 0px">
                                    <div class="single-product">
                                        <div class="product-img">
                                            <a href="product-details.html"><img class="default-img" src="images/products/p1.jpg" alt="#"> <img class="hover-img" src="images/products/p2.jpg" alt="#"></a>
                                            <div class="button-head">
                                                <div class="product-action"><a data-toggle="modal" data-target="#exampleModal" title="Quick View" href="#"><i class="ti-eye"></i><span>Quick Shop</span></a> <a title="Wishlist" href="#"><i class="ti-heart"></i><span>Add to Wishlist</span></a> <a title="Compare" href="#"><i class="ti-bar-chart-alt"></i><span>Add to Compare</span></a></div>
                                                <div class="product-action-2"><a title="Add to cart" href="#">Add to cart</a></div>
                                            </div>
                                        </div>
                                        <div class="product-content">
                                            <h3><a href="product-details.html">Women Hot Collection</a></h3>
                                            <div class="product-price"><span>$50.00</span></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="owl-item cloned" style="width: 285px; margin-right: 0px">
                                    <div class="single-product">
                                        <div class="product-img">
                                            <a href="product-details.html"><img class="default-img" src="images/products/p3.jpg" alt="#"> <img class="hover-img" src="images/products/p4.jpg" alt="#"> <span class="new">New</span></a>
                                            <div class="button-head">
                                                <div class="product-action"><a data-toggle="modal" data-target="#exampleModal" title="Quick View" href="#"><i class="ti-eye"></i><span>Quick Shop</span></a> <a title="Wishlist" href="#"><i class="ti-heart"></i><span>Add to Wishlist</span></a> <a title="Compare" href="#"><i class="ti-bar-chart-alt"></i><span>Add to Compare</span></a></div>
                                                <div class="product-action-2"><a title="Add to cart" href="#">Add to cart</a></div>
                                            </div>
                                        </div>
                                        <div class="product-content">
                                            <h3><a href="product-details.html">Awesome Pink Show</a></h3>
                                            <div class="product-price"><span>$50.00</span></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="owl-item cloned" style="width: 285px; margin-right: 0px">
                                    <div class="single-product">
                                        <div class="product-img">
                                            <a href="product-details.html"><img class="default-img" src="images/products/p5.jpg" alt="#"> <img class="hover-img" src="images/products/p6.jpg" alt="#"></a>
                                            <div class="button-head">
                                                <div class="product-action"><a data-toggle="modal" data-target="#exampleModal" title="Quick View" href="#"><i class="ti-eye"></i><span>Quick Shop</span></a> <a title="Wishlist" href="#"><i class="ti-heart"></i><span>Add to Wishlist</span></a> <a title="Compare" href="#"><i class="ti-bar-chart-alt"></i><span>Add to Compare</span></a></div>
                                                <div class="product-action-2"><a title="Add to cart" href="#">Add to cart</a></div>
                                            </div>
                                        </div>
                                        <div class="product-content">
                                            <h3><a href="product-details.html">Awesome Bags Collection</a></h3>
                                            <div class="product-price"><span>$50.00</span></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="owl-item" style="width: 285px; margin-right: 0px">
                                    <div class="single-product">
                                        <div class="product-img">
                                            <a href="product-details.html"><img class="default-img" src="images/products/p15.jpg" alt="#"> <img class="hover-img" src="images/products/p16.jpg" alt="#"> <span class="out-of-stock">Hot</span></a>
                                            <div class="button-head">
                                                <div class="product-action"><a data-toggle="modal" data-target="#exampleModal" title="Quick View" href="#"><i class="ti-eye"></i><span>Quick Shop</span></a> <a title="Wishlist" href="#"><i class="ti-heart"></i><span>Add to Wishlist</span></a> <a title="Compare" href="#"><i class="ti-bar-chart-alt"></i><span>Add to Compare</span></a></div>
                                                <div class="product-action-2"><a title="Add to cart" href="#">Add to cart</a></div>
                                            </div>
                                        </div>
                                        <div class="product-content">
                                            <h3><a href="product-details.html">Black Sunglass For Women</a></h3>
                                            <div class="product-price"><span class="old">$60.00</span> <span>$50.00</span></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="owl-item" style="width: 285px; margin-right: 0px">
                                    <div class="single-product">
                                        <div class="product-img">
                                            <a href="product-details.html"><img class="default-img" src="images/products/p1.jpg" alt="#"> <img class="hover-img" src="images/products/p2.jpg" alt="#"></a>
                                            <div class="button-head">
                                                <div class="product-action"><a data-toggle="modal" data-target="#exampleModal" title="Quick View" href="#"><i class="ti-eye"></i><span>Quick Shop</span></a> <a title="Wishlist" href="#"><i class="ti-heart"></i><span>Add to Wishlist</span></a> <a title="Compare" href="#"><i class="ti-bar-chart-alt"></i><span>Add to Compare</span></a></div>
                                                <div class="product-action-2"><a title="Add to cart" href="#">Add to cart</a></div>
                                            </div>
                                        </div>
                                        <div class="product-content">
                                            <h3><a href="product-details.html">Women Hot Collection</a></h3>
                                            <div class="product-price"><span>$50.00</span></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="owl-item" style="width: 285px; margin-right: 0px">
                                    <div class="single-product">
                                        <div class="product-img">
                                            <a href="product-details.html"><img class="default-img" src="images/products/p3.jpg" alt="#"> <img class="hover-img" src="images/products/p4.jpg" alt="#"> <span class="new">New</span></a>
                                            <div class="button-head">
                                                <div class="product-action"><a data-toggle="modal" data-target="#exampleModal" title="Quick View" href="#"><i class="ti-eye"></i><span>Quick Shop</span></a> <a title="Wishlist" href="#"><i class="ti-heart"></i><span>Add to Wishlist</span></a> <a title="Compare" href="#"><i class="ti-bar-chart-alt"></i><span>Add to Compare</span></a></div>
                                                <div class="product-action-2"><a title="Add to cart" href="#">Add to cart</a></div>
                                            </div>
                                        </div>
                                        <div class="product-content">
                                            <h3><a href="product-details.html">Awesome Pink Show</a></h3>
                                            <div class="product-price"><span>$50.00</span></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="owl-item active" style="width: 285px; margin-right: 0px">
                                    <div class="single-product">
                                        <div class="product-img">
                                            <a href="product-details.html"><img class="default-img" src="images/products/p5.jpg" alt="#"> <img class="hover-img" src="images/products/p6.jpg" alt="#"></a>
                                            <div class="button-head">
                                                <div class="product-action"><a data-toggle="modal" data-target="#exampleModal" title="Quick View" href="#"><i class="ti-eye"></i><span>Quick Shop</span></a> <a title="Wishlist" href="#"><i class="ti-heart"></i><span>Add to Wishlist</span></a> <a title="Compare" href="#"><i class="ti-bar-chart-alt"></i><span>Add to Compare</span></a></div>
                                                <div class="product-action-2"><a title="Add to cart" href="#">Add to cart</a></div>
                                            </div>
                                        </div>
                                        <div class="product-content">
                                            <h3><a href="product-details.html">Awesome Bags Collection</a></h3>
                                            <div class="product-price"><span>$50.00</span></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="owl-item cloned active" style="width: 285px; margin-right: 0px">
                                    <div class="single-product">
                                        <div class="product-img">
                                            <a href="product-details.html"><img class="default-img" src="images/products/p15.jpg" alt="#"> <img class="hover-img" src="images/products/p16.jpg" alt="#"> <span class="out-of-stock">Hot</span></a>
                                            <div class="button-head">
                                                <div class="product-action"><a data-toggle="modal" data-target="#exampleModal" title="Quick View" href="#"><i class="ti-eye"></i><span>Quick Shop</span></a> <a title="Wishlist" href="#"><i class="ti-heart"></i><span>Add to Wishlist</span></a> <a title="Compare" href="#"><i class="ti-bar-chart-alt"></i><span>Add to Compare</span></a></div>
                                                <div class="product-action-2"><a title="Add to cart" href="#">Add to cart</a></div>
                                            </div>
                                        </div>
                                        <div class="product-content">
                                            <h3><a href="product-details.html">Black Sunglass For Women</a></h3>
                                            <div class="product-price"><span class="old">$60.00</span> <span>$50.00</span></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="owl-item cloned active" style="width: 285px; margin-right: 0px">
                                    <div class="single-product">
                                        <div class="product-img">
                                            <a href="product-details.html"><img class="default-img" src="images/products/p1.jpg" alt="#"> <img class="hover-img" src="images/products/p2.jpg" alt="#"></a>
                                            <div class="button-head">
                                                <div class="product-action"><a data-toggle="modal" data-target="#exampleModal" title="Quick View" href="#"><i class="ti-eye"></i><span>Quick Shop</span></a> <a title="Wishlist" href="#"><i class="ti-heart"></i><span>Add to Wishlist</span></a> <a title="Compare" href="#"><i class="ti-bar-chart-alt"></i><span>Add to Compare</span></a></div>
                                                <div class="product-action-2"><a title="Add to cart" href="#">Add to cart</a></div>
                                            </div>
                                        </div>
                                        <div class="product-content">
                                            <h3><a href="product-details.html">Women Hot Collection</a></h3>
                                            <div class="product-price"><span>$50.00</span></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="owl-item cloned active" style="width: 285px; margin-right: 0px">
                                    <div class="single-product">
                                        <div class="product-img">
                                            <a href="product-details.html"><img class="default-img" src="images/products/p3.jpg" alt="#"> <img class="hover-img" src="images/products/p4.jpg" alt="#"> <span class="new">New</span></a>
                                            <div class="button-head">
                                                <div class="product-action"><a data-toggle="modal" data-target="#exampleModal" title="Quick View" href="#"><i class="ti-eye"></i><span>Quick Shop</span></a> <a title="Wishlist" href="#"><i class="ti-heart"></i><span>Add to Wishlist</span></a> <a title="Compare" href="#"><i class="ti-bar-chart-alt"></i><span>Add to Compare</span></a></div>
                                                <div class="product-action-2"><a title="Add to cart" href="#">Add to cart</a></div>
                                            </div>
                                        </div>
                                        <div class="product-content">
                                            <h3><a href="product-details.html">Awesome Pink Show</a></h3>
                                            <div class="product-price"><span>$50.00</span></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="owl-item cloned" style="width: 285px; margin-right: 0px">
                                    <div class="single-product">
                                        <div class="product-img">
                                            <a href="product-details.html"><img class="default-img" src="images/products/p5.jpg" alt="#"> <img class="hover-img" src="images/products/p6.jpg" alt="#"></a>
                                            <div class="button-head">
                                                <div class="product-action"><a data-toggle="modal" data-target="#exampleModal" title="Quick View" href="#"><i class="ti-eye"></i><span>Quick Shop</span></a> <a title="Wishlist" href="#"><i class="ti-heart"></i><span>Add to Wishlist</span></a> <a title="Compare" href="#"><i class="ti-bar-chart-alt"></i><span>Add to Compare</span></a></div>
                                                <div class="product-action-2"><a title="Add to cart" href="#">Add to cart</a></div>
                                            </div>
                                        </div>
                                        <div class="product-content">
                                            <h3><a href="product-details.html">Awesome Bags Collection</a></h3>
                                            <div class="product-price"><span>$50.00</span></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="owl-controls">
                            <div class="owl-nav">
                                <div class="owl-prev"><i class="ti-angle-left"></i></div>
                                <div class="owl-next"><i class="ti-angle-right"></i></div>
                            </div>
                            <div class="owl-dots" style="display: none"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- End Most Popular Area -->

@code {
	[Parameter]
    public string friendlyProductUrl { get; set; }

    [Parameter]
    public int ProductOptionProductInstanceId { get; set; }

    [Parameter]
    public string ProductPrice { get; set; }

    [Parameter]
    public int ProductStock {get;set;}

    [Parameter]
    public int ProductQuantity {get;set;}

    private BlazorCommerce.Shared.ProductDto _product;

    private void DecrementQuantity()
    {
        if (ProductQuantity <= 1)
        {
            ProductQuantity = 1;
        }
        else
        {
            ProductQuantity--;
        }
    }

    private void IncrementQuantity()
    {
        if (ProductQuantity >= ProductStock)
        {
            ProductQuantity = ProductStock;
        }
        else
        {
            ProductQuantity++;
        }
    }

    public async Task AddItemToCart()
    {
        var cartItem = new AddItemToCartDto{
            CartGuid = await JSRuntime.InvokeAsync<string>("getCartCookie"),
            ProductOptionProductInstanceId = ProductOptionProductInstanceId,
            Quantity = ProductQuantity
        };
        await Http.PostAsJsonAsync("cart/additemtocart", cartItem);
        await JSRuntime.InvokeVoidAsync("notifyUpdateToCart");
    }

    private void UpdateSelectedProductOption(int productOptionProductInstanceId, decimal productPrice, int productStock)
    {
        ProductOptionProductInstanceId = productOptionProductInstanceId;
        ProductPrice = string.Format("£{0:0.00}", productPrice);
        ProductStock = productStock;
        ProductQuantity = 1;
    }

    protected override async Task OnParametersSetAsync()
    {
        _product = await Http.GetFromJsonAsync<BlazorCommerce.Shared.ProductDto>($"product/{friendlyProductUrl}");
        ProductOptionProductInstanceId = _product.ProductOptionProductInstanceId;
        ProductPrice = string.Format("£{0:0.00}", _product.Price);
        ProductStock = _product.Stock;
        ProductQuantity = 1;
        await Http.PostAsync($"product/incrementnumberoftimesviewed/{friendlyProductUrl}", null);
    }

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        await JSRuntime.InvokeVoidAsync("setFlexSlider");
    }

    protected string DoPlaceholderReplacements(string source)
    {
        return source.Replace("__p__", "<p>").Replace("__cp__", "</p><br>");
    }

	public override async Task SetParametersAsync(ParameterView parameters)
	{
		AppState.SetDisplayCategoryMenuInHeaderNav(false);
		await base.SetParametersAsync(parameters);
	}
}